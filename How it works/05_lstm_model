"""
=========================================================
05_lstm_model.py
=========================================================

PROJECT STAGE:
Deep Learning Forecasting Engine

---------------------------------------------------------
üéØ PURPOSE OF THIS FILE
---------------------------------------------------------
This file builds and trains the LSTM (Long Short-Term Memory) 
neural network model for demand forecasting.

It represents the primary predictive engine of the system.

The objective:
Learn temporal patterns in historical demand and predict 
future sales accurately.

---------------------------------------------------------
üß† WHY LSTM WAS CHOSEN
---------------------------------------------------------
Retail demand data is sequential and time-dependent.

Traditional models:
‚Ä¢ Struggle with long-term dependencies
‚Ä¢ Cannot capture complex nonlinear relationships

LSTM is designed to:
‚Ä¢ Remember long-term patterns
‚Ä¢ Handle time-series sequences
‚Ä¢ Capture nonlinear demand behavior
‚Ä¢ Learn seasonality and trend implicitly

---------------------------------------------------------
‚öôÔ∏è WHAT HAPPENS INSIDE THIS FILE
---------------------------------------------------------

1Ô∏è‚É£ Model Architecture Definition

Typical architecture includes:
‚Ä¢ LSTM layers
‚Ä¢ Dropout layers (to prevent overfitting)
‚Ä¢ Dense output layer

Input shape:
(window_size, 1)

2Ô∏è‚É£ Model Compilation

Loss function:
‚Ä¢ Mean Squared Error (MSE)

Optimizer:
‚Ä¢ Adam (adaptive learning rate)

3Ô∏è‚É£ Model Training

The model is trained on:
‚Ä¢ Preprocessed sequences
‚Ä¢ Training dataset only

Validation set monitors overfitting.

4Ô∏è‚É£ Model Saving

After training, the model is saved as:

outputs/model/lstm_model.keras

This allows:
‚Ä¢ Reusability
‚Ä¢ Deployment without retraining
‚Ä¢ Separation of training and inference

---------------------------------------------------------
üìä WHAT THE MODEL LEARNS
---------------------------------------------------------
The LSTM learns:

‚Ä¢ Demand trends
‚Ä¢ Seasonality patterns
‚Ä¢ Short-term fluctuations
‚Ä¢ Implicit price effects (if included)
‚Ä¢ Complex nonlinear behavior

---------------------------------------------------------
üîó HOW IT CONNECTS TO THE PROJECT
---------------------------------------------------------
This model powers:

‚Üí 06_uncertainty_estimation.py
‚Üí 07_drift_detection.py
‚Üí 08_inventory_decision_layer.py
‚Üí model_comparison.py
‚Üí Streamlit dashboard forecasting
‚Üí What-if simulation logic
‚Üí AI recommendation engine

Without this file:
There is no forecasting capability.

---------------------------------------------------------
üèó ARCHITECTURAL POSITION
---------------------------------------------------------
Layer 1: Data
Layer 2: Validation
Layer 3: EDA
Layer 4: Preprocessing
Layer 5: Baseline Models
Layer 6: Deep Learning Model   ‚Üê This file
Layer 7: Intelligence & Decision Layer
Layer 8: Deployment

---------------------------------------------------------

"I implemented an LSTM-based forecasting model to capture 
temporal dependencies in retail demand. The model was trained 
on sliding window sequences and saved as a reusable artifact 
for real-time inference within the deployed dashboard."

---------------------------------------------------------
üß† KEY LEARNING
---------------------------------------------------------
Deep learning is powerful, but:

‚Ä¢ Requires proper preprocessing
‚Ä¢ Requires baseline comparison
‚Ä¢ Must be validated properly
‚Ä¢ Should be saved as an artifact for deployment

The model is not the system.
It is one component of a larger intelligence architecture.
=========================================================
"""
