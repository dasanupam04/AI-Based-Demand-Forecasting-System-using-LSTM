"""
=========================================================
03_preprocessing.py
=========================================================

PROJECT STAGE:
Data Preparation & Sequence Engineering

---------------------------------------------------------
üéØ PURPOSE OF THIS FILE
---------------------------------------------------------
This file transforms raw demand data into a 
model-ready format suitable for time-series forecasting.

Machine learning models, especially LSTM, require:

‚Ä¢ Scaled numerical inputs
‚Ä¢ Sequential structured data
‚Ä¢ Proper train-test splits

This file prepares the dataset for modeling.

---------------------------------------------------------
üß† WHAT PROBLEM THIS FILE SOLVES
---------------------------------------------------------
Raw data cannot be directly fed into LSTM models.

Problems addressed here:

‚Ä¢ Neural networks are sensitive to scale.
‚Ä¢ Time-series forecasting requires sequences.
‚Ä¢ Future data must not leak into training data.
‚Ä¢ Data must be reshaped into 3D format for LSTM.

Without preprocessing:
The model will either fail or learn incorrectly.

---------------------------------------------------------
‚öôÔ∏è WHAT HAPPENS INSIDE THIS FILE
---------------------------------------------------------

1Ô∏è‚É£ Scaling the Demand Series

   The Units Sold column is scaled using MinMaxScaler.

   Why?
   Neural networks train better when data is in 
   a normalized range (0‚Äì1).

2Ô∏è‚É£ Creating Time-Series Sequences

   Using a sliding window approach:
   Example:
   If window_size = 30

   Model input:
   Day 1 ‚Üí Day 30
   Output:
   Day 31

   This converts the dataset into supervised learning format.

3Ô∏è‚É£ Splitting into Train & Test Sets

   Unlike random splitting,
   time-series must preserve order.

   First 80% ‚Üí Training
   Last 20% ‚Üí Testing

   This prevents data leakage.

---------------------------------------------------------
üìä WHY THIS STEP IS CRITICAL
---------------------------------------------------------
This step:

‚Ä¢ Converts raw retail demand into structured sequences
‚Ä¢ Enables LSTM to learn temporal dependencies
‚Ä¢ Maintains chronological integrity
‚Ä¢ Ensures model generalization

This is the technical bridge between data and AI.

---------------------------------------------------------
üîó HOW IT CONNECTS TO THE PROJECT
---------------------------------------------------------
Feeds directly into:

‚Üí 04_baseline_models.py
‚Üí 05_lstm_model.py
‚Üí 06_uncertainty_estimation.py
‚Üí 14_model_comparison.py

Every forecasting model depends on this structured data.

---------------------------------------------------------
üèó ARCHITECTURAL POSITION
---------------------------------------------------------
Layer 1: Raw Data
Layer 2: Validation
Layer 3: EDA
Layer 4: Feature Engineering & Sequence Creation  ‚Üê This file
Layer 5: Modeling
Layer 6: Intelligence Layer

---------------------------------------------------------

"I implemented a preprocessing layer that scaled the 
demand data and converted it into sliding window 
sequences, allowing the LSTM model to learn temporal 
patterns effectively while preventing data leakage."

---------------------------------------------------------
üß† KEY LEARNING
---------------------------------------------------------
AI models do not understand time.
We must explicitly convert time-series data into 
supervised sequences.

Data preparation determines model performance 
more than model complexity.
=========================================================
"""
